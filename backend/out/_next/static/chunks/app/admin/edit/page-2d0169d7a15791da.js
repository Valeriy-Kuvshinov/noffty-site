(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[615],{8849:function(e,a,t){Promise.resolve().then(t.bind(t,4592))},6463:function(e,a,t){"use strict";var n=t(1169);t.o(n,"usePathname")&&t.d(a,{usePathname:function(){return n.usePathname}}),t.o(n,"useRouter")&&t.d(a,{useRouter:function(){return n.useRouter}}),t.o(n,"useSearchParams")&&t.d(a,{useSearchParams:function(){return n.useSearchParams}})},4592:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return w}});var n=t(7437),l=t(2265),r=t(6463),s=t(1641),i=t(5682),o=t(8804),c=t(4021),d=t(6370),m=t(3810);function u(e){let{index:a,defaultImgUrl:t,folderName:r,onUploaded:s}=e,[i,o]=(0,l.useState)(""),[u,h]=(0,l.useState)(!1),{cloudinary:g}=(0,c.n)(),{cloudName:p,uploadPreset:x}=g,f="imgUpload-".concat(a);async function v(e){let t=e.size/1024/1024>2?{isValid:!1,errorHeader:"File Too Big!",errorMessage:"File size exceeds 2 MB!"}:["image/avif"].includes(e.type)?((0,m.C)("File Uploaded!","Game images updated."),{isValid:!0}):{isValid:!1,errorHeader:"Invalid Format!",errorMessage:"Only AVIF is allowed!"};if(!t.isValid){(0,m.o)("".concat(t.errorHeader),"".concat(t.errorMessage));return}h(!0);try{let t=await j(e,r,p,x);o(t.secure_url),s({url:t.secure_url,index:a})}catch(e){console.error("Upload failed",e),(0,m.o)("Upload Failed!",e.message)}finally{h(!1)}}async function j(e,a,t,n){try{let l=new FormData;l.append("upload_preset",n),l.append("file",e),l.append("folder",a);let r=await fetch("https://api.cloudinary.com/v1_1/".concat(t,"/image/upload"),{method:"POST",body:l});return await r.json()}catch(e){throw console.error("Failed to upload",e),e}}return(0,l.useEffect)(()=>{t!==i&&o(t)},[t,i]),(0,n.jsx)("article",{className:"upload-preview",role:"region","aria-labelledby":"upload-label","aria-describedby":"upload-description",onDragOver:function(e){e.preventDefault(),e.stopPropagation(),e.currentTarget.classList.add("drag-over")},onDragLeave:function(e){e.preventDefault(),e.stopPropagation(),e.currentTarget.classList.remove("drag-over")},onDrop:function(e){e.preventDefault(),e.stopPropagation(),e.currentTarget.classList.remove("drag-over");let a=e.dataTransfer.files;a&&a.length>0&&v(a[0])},children:(0,n.jsxs)("div",{className:"file-upload-container flex column",children:[(0,n.jsxs)("label",{htmlFor:f,className:"flex column fast-trans",id:"upload-label",children:[(0,n.jsx)("span",{id:"upload-description",className:"family-bold text-center fast-trans w-100",children:i?"Replace Image?":u?"Uploading....":"Upload Image"}),i&&(0,n.jsx)(d.ImageContainer,{src:i,alt:"preview image"})]}),(0,n.jsx)("input",{type:"file",onChange:function(e){e.target.files&&e.target.files.length>0&&v(e.target.files[0])},accept:"image/*",id:f,style:{display:"none"},"aria-labelledby":"upload-label","aria-describedby":"upload-description"})]})})}var h=t(4148),g=t(1101),p=t(9714),x=t(1551),f=t(6168);function v(e){let{game:a}=e;return(0,n.jsxs)("article",{className:"edit-preview flex column w-100",children:[(0,n.jsxs)("h2",{className:"text-center",children:["Preview: ",a.title]}),(0,n.jsxs)("div",{className:"game-frame flex column w-100 text-center",children:[(0,n.jsxs)("h3",{children:["You Are Now Playing ",a.title]}),"html5"===a.platform?a.gameLink?(0,n.jsx)("div",{className:"iframe-placeholder flex full-center",children:(0,n.jsx)("p",{children:"Gameplay would be shown here"})}):(0,n.jsx)("p",{children:"Game not published or inaccessible"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:["Whoa, looks like the game is not intended for the browser, but for",(0,n.jsxs)("span",{className:"text-capitalize",children:[" ",a.platform]})," instead."]}),(0,n.jsxs)("a",{href:a.outsideLink,className:"flex row",target:"_blank",rel:"noopener noreferrer","aria-label":"Navigate to game's actual platform?",children:[(0,n.jsx)(h.M,{iconName:a.platform}),(0,n.jsx)("span",{children:"Take Me to The Game!"}),(0,n.jsx)(h.M,{iconName:a.platform})]})]})]}),(0,n.jsx)(j,{game:a})]})}function j(e){var a,t;let{game:l}=e,{openModal:r}=(0,x.d)(),s="Stoic^2"===l.title||"Absurd^2"===l.title,i=p.N.formatText(l.description||""),o=p.N.formatText(l.controls||""),c=p.N.formatText(l.credits||""),m=p.N.formatText(l.specialNote||"");return(0,n.jsxs)("div",{className:"game-body flex column w-100 layout-row",children:[(0,n.jsx)("h3",{className:"text-center",children:l.subtitle}),(0,n.jsx)("div",{className:"screenshots flex row ".concat("android"!==l.platform&&l.screenshots.length>=5?"w-100":""),children:l.screenshots.slice(1).map((e,a)=>(0,n.jsx)(d.ImageContainer,{src:e,className:"h-100",alt:"".concat(l.title," screenshot number ").concat(a+1),style:{maxHeight:l.screenshots.length<5?"215px":"auto",aspectRatio:"android"!==l.platform?"16 / 9":"9 / 16"},onClick:()=>{r("image-modal",e)}},a))}),(0,n.jsx)(f.p,{string:i}),(0,n.jsx)(f.p,{string:"Controls: ".concat(o)}),(0,n.jsx)(f.p,{string:c}),l.specialNote&&(s?(0,n.jsx)(f.p,{string:m,custom:"special"}):(0,n.jsx)(f.p,{string:m})),(0,n.jsxs)("div",{className:"video-wrapper grid w-100",children:[l.walkthrough&&(0,n.jsxs)("div",{className:"video flex column w-100",children:[(0,n.jsx)("p",{className:"text-hide-overflow",children:"If you're stuck, we've got you covered:"}),(0,n.jsx)("div",{className:"iframe flex column full-center",children:(0,n.jsx)("p",{className:"text-center",children:"Walkthrough video will be shown here..."})})]}),l.devlog&&(0,n.jsxs)("div",{className:"video flex column w-100",children:[(0,n.jsx)("p",{className:"text-hide-overflow",children:"Be sure to check out the developer's log:"}),(0,n.jsx)("div",{className:"iframe flex column full-center",children:(0,n.jsx)("p",{className:"text-center",children:"Devlog video will be shown here..."})})]})]}),(0,n.jsxs)("div",{className:"game-info flex column w-100",children:[(0,n.jsxs)("p",{className:"flex",children:[(0,n.jsx)("span",{className:"text-right",children:"Published"}),p.N.formatDate(l.createdAt)," GMT / UTC"]}),(0,n.jsxs)("p",{className:"flex",children:[(0,n.jsx)("span",{className:"text-right",children:"Platform"}),l.platform.includes("html5")?p.N.upperCaseString(l.platform):p.N.capitalizeString(l.platform)]}),(0,n.jsxs)("p",{className:"flex",children:[(0,n.jsx)("span",{className:"text-right",children:"Genre"}),null===(a=l.genre)||void 0===a?void 0:a.map(e=>p.N.capitalizeString(e)).join(", ")]}),(null===(t=l.outsideLink)||void 0===t?void 0:t.includes("itch.io"))&&(0,n.jsxs)("a",{href:l.outsideLink,target:"_blank","aria-label":"navigation to itch.io",title:"Go to itch.io?",rel:"noopener noreferrer",className:"flex row align-center w-fit",children:[(0,n.jsx)(h.M,{iconName:"itch"}),(0,n.jsx)("span",{children:"Available on Itch.io as well!"}),(0,n.jsx)(h.M,{iconName:"itch"})]})]})]})}function b(e){let{game:a}=e,t=(0,r.useRouter)(),c=s.R.getGenres().slice(1),d=s.R.getPlatforms().slice(1),p=s.R.getGameJams().slice(1),{values:x,errors:f,setErrors:j,validateField:b,handleChange:N,handleSubmit:y,resetForm:w,setFieldValue:k}=(0,i.c)(a,{title:{required:!0,minLength:3,pattern:/[\s.\-!^&?']+/},subtitle:{required:!0,minLength:3,pattern:/[\s.\-!?']+/},outsideLink:{required:!0,minLength:3,link:!0},gameLink:{minLength:3,link:!0},devlog:{minLength:3,link:!0},walkthrough:{minLength:3,link:!0},description:{required:!0,minLength:15,pattern:/[\s.\-!?@#$',^*_;():]+/},credits:{required:!0,minLength:3,pattern:/[\s.\-!?@#$',^*_();:]+/},controls:{required:!0,minLength:3,pattern:/[\s.\-!?@#$',^/*();:]+/},specialNote:{minLength:9,pattern:/[\s.\-!?@#$"',^*_;():]+/}},async e=>{try{await s.R.save(e),(0,m.C)("Game Saved!","Game database updated."),w(),t.push("/admin/games")}catch(e){(0,m.o)("Save Failed!",e.message),console.error("Failed to save game",e)}}),L=(0,o.N)(x.title,500);function C(e){let a=[...x.screenshots];a[e.index]=e.url,k("screenshots",a)}async function S(){if(a._id)try{await s.R.remove(a._id.toString()),(0,m.C)("Game Deleted!","Game database updated."),t.push("/admin/games")}catch(e){(0,m.o)("Deletion Failed!",e.message),console.error("Failed to delete game",e)}}(0,l.useEffect)(()=>{L&&e(L);async function e(e){try{if(e===a.title){j(e=>({...e,title:null}));return}let{isAvailable:t}=await s.R.checkNameAvailable(e);j(e=>({...e,title:t?null:"Name is taken"}))}catch(e){console.error("Failed to check name availability",e),j(e=>({...e,title:"Error checking name availability"}))}}},[L,a.title,j]);let G=x.title&&x.subtitle&&x.outsideLink&&x.description&&x.credits&&x.controls,R=Object.values(f).some(e=>e);return(0,n.jsxs)("form",{className:"grid layout-row w-100",onSubmit:y,children:[(0,n.jsx)(v,{game:x}),(0,n.jsxs)("article",{className:"form-inputs grid w-100",children:[(0,n.jsxs)("section",{className:"special-layout grid align-center w-100 h-fit",children:[(0,n.jsx)(g.o,{label:"Game Title*",svg:"title",type:"text",name:"title",maxLength:40,value:x.title,onChange:N,error:f.title,onBlur:()=>b("title",x.title)}),(0,n.jsx)(g.o,{label:"Game Subtitle*",svg:"info",type:"text",name:"subtitle",maxLength:40,value:x.subtitle,onChange:N,error:f.subtitle,onBlur:()=>b("subtitle",x.subtitle)}),(0,n.jsx)(g.o,{label:"Outside Link*",svg:"link",type:"text",name:"outsideLink",maxLength:120,value:x.outsideLink||"",onChange:N,error:f.outsideLink,onBlur:()=>b("outsideLink",x.outsideLink)}),(0,n.jsx)(g.o,{label:"Files Link",svg:"folder",type:"text",name:"gameLink",maxLength:120,value:x.gameLink||"",onChange:N,error:f.gameLink,onBlur:()=>b("gameLink",x.gameLink||"")}),(0,n.jsx)(g.o,{label:"Devlog Link",svg:"link",type:"text",name:"devlog",maxLength:120,value:x.devlog||"",onChange:N,error:f.devlog,onBlur:()=>b("devlog",x.devlog||"")}),(0,n.jsx)(g.o,{label:"Walkthrough Link",svg:"link",type:"text",name:"walkthrough",maxLength:120,value:x.walkthrough||"",onChange:N,error:f.walkthrough,onBlur:()=>b("walkthrough",x.walkthrough||"")}),(0,n.jsx)(g.o,{label:"Description*",svg:"description",type:"textarea",name:"description",maxLength:900,value:x.description||"",onChange:N,error:f.description,onBlur:()=>b("description",x.description)})]}),(0,n.jsx)(g.o,{label:"Credits*",svg:"agreement",type:"textarea",name:"credits",maxLength:120,value:x.credits||"",onChange:N,error:f.credits,onBlur:()=>b("credits",x.credits)}),(0,n.jsx)(g.o,{label:"Controls*",svg:"keyboard",type:"textarea",name:"controls",maxLength:120,value:x.controls||"",onChange:N,error:f.controls,onBlur:()=>b("controls",x.controls)}),(0,n.jsx)(g.o,{label:"Note",svg:"info",type:"textarea",name:"specialNote",maxLength:600,value:x.specialNote||"",onChange:N,error:f.specialNote,onBlur:()=>b("specialNote",x.specialNote)}),(0,n.jsxs)("section",{className:"special-layout grid align-center w-100 h-fit",children:[(0,n.jsxs)("div",{className:"input-area grid",children:[(0,n.jsxs)("label",{className:"grid align-center",htmlFor:"genre",children:[(0,n.jsx)(h.M,{iconName:"action"}),(0,n.jsx)("span",{children:"Genre:"})]}),(0,n.jsx)("select",{id:"genre",name:"genre",multiple:!0,value:x.genre,onChange:function(e){k("genre",Array.from(e.target.selectedOptions,e=>e.value))},children:c.map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,n.jsxs)("div",{className:"input-area grid h-fit",children:[(0,n.jsxs)("label",{className:"grid align-center",htmlFor:"platform",children:[(0,n.jsx)(h.M,{iconName:"monitor"}),(0,n.jsx)("span",{children:"Platform:"})]}),(0,n.jsx)("select",{id:"platform",name:"platform",value:x.platform,onChange:N,required:!0,children:d.map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,n.jsxs)("div",{className:"input-area grid",children:[(0,n.jsxs)("label",{className:"grid align-center",htmlFor:"isGameJam",children:[(0,n.jsx)(h.M,{iconName:"itch"}),(0,n.jsx)("span",{children:"Is Game Jam:"})]}),(0,n.jsx)("select",{id:"isGameJam",name:"isGameJam",value:x.isGameJam,onChange:N,required:!0,children:p.map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,n.jsxs)("div",{className:"input-area grid h-fit",children:[(0,n.jsxs)("label",{className:"grid align-center",htmlFor:"icon",children:[(0,n.jsx)(h.M,{iconName:"images"}),(0,n.jsx)("span",{children:"Icon:"})]}),(0,n.jsx)("div",{className:"upload-area grid",children:(0,n.jsx)(u,{index:-1,defaultImgUrl:a.icon||"https://res.cloudinary.com/djzid7ags/image/upload/v1719002261/vohr6yravygkly4duxhv.avif",folderName:"/games/icons",onUploaded:function(e){k("icon",e.url)}})})]}),(0,n.jsxs)("div",{className:"input-area grid h-fit",children:[(0,n.jsxs)("label",{className:"grid align-center",htmlFor:"screenshots",children:[(0,n.jsx)(h.M,{iconName:"images"}),(0,n.jsx)("span",{children:"Screenshots:"})]}),(0,n.jsxs)("div",{className:"upload-area grid",children:[x.screenshots.map((e,a)=>(0,n.jsx)("div",{children:(0,n.jsx)(u,{index:a,defaultImgUrl:e||"https://res.cloudinary.com/djzid7ags/image/upload/v1719002299/zmbzvexomb5jmawvpqzd.avif",folderName:"/games/screenshots",onUploaded:C})},a)),(0,n.jsxs)("div",{className:"amount-management grid",children:[(0,n.jsxs)("button",{type:"button",onClick:()=>(function(e){if(x.screenshots.length>1){let a=[...x.screenshots];a.splice(e,1),k("screenshots",a)}})(x.screenshots.length-1),disabled:1===x.screenshots.length,className:"flex column full-center ".concat(1===x.screenshots.length?"disabled":""),children:[(0,n.jsx)(h.M,{iconName:"minus"}),(0,n.jsx)("span",{children:"Remove"})]}),(0,n.jsxs)("button",{type:"button",onClick:function(){x.screenshots.length<5&&k("screenshots",[...x.screenshots,""])},disabled:x.screenshots.length>=5,className:"flex column full-center ".concat(x.screenshots.length>=5?"disabled":""),children:[(0,n.jsx)(h.M,{iconName:"plus"}),(0,n.jsx)("span",{children:"Add"})]})]})]})]}),(0,n.jsxs)("section",{className:"form-actions flex row align-center justify-between",children:[(0,n.jsx)("button",{className:"flex row align-center ".concat(!G||R?"disabled":""),type:"submit",disabled:!G||R,children:(0,n.jsx)("span",{children:"Send"})}),a._id&&(0,n.jsx)("button",{className:"flex row align-center",type:"button",onClick:S,children:(0,n.jsx)("span",{children:"Delete"})})]})]})]})}var N=t(1811),y=t(2817);function w(){let e=(0,r.useSearchParams)(),[a,t]=(0,l.useState)(null),[i,o]=(0,l.useState)(!0),[c,d]=(0,l.useState)(null),[m,u]=(0,l.useState)(!1),g=(0,l.useMemo)(()=>({title:"New Game",subtitle:"To Be Continued",icon:"https://res.cloudinary.com/djzid7ags/image/upload/v1719002261/vohr6yravygkly4duxhv.avif",screenshots:["https://res.cloudinary.com/djzid7ags/image/upload/v1719002299/zmbzvexomb5jmawvpqzd.avif"],platform:"html5",outsideLink:"https://t1mure.itch.io/absurd2",gameLink:"https://html-classic.itch.zone/html/9577176/index.html",description:"Game info for the user",credits:"Game stuff by T1mure",controls:"WASD / Space keys to move",specialNote:"Disclaimer or gmtk thing",genre:["action"],devlog:"",walkthrough:"",isGameJam:"no",createdAt:Date.now()}),[]);return(0,l.useEffect)(()=>{(async function(){let a=e.get("name");if(!a){u(!0),t(g),o(!1);return}try{let e=await s.R.getByName(a);if(e){var n,l,r,i;t({...e,description:null===(n=e.description)||void 0===n?void 0:n.replace(/<br>/g,"\n"),controls:null===(l=e.controls)||void 0===l?void 0:l.replace(/<br>/g,"\n"),credits:null===(r=e.credits)||void 0===r?void 0:r.replace(/<br>/g,"\n"),specialNote:null===(i=e.specialNote)||void 0===i?void 0:i.replace(/<br>/g,"\n")}),u(!1)}else d("Sorry, no game found matching ".concat(a,"."))}catch(e){console.error("Failed to fetch game",e),d("An error occurred while fetching the game.")}finally{o(!1)}})()},[e,g]),(0,n.jsx)("main",{className:"edit-page full w-h-100",children:(0,n.jsxs)("section",{className:"page-contents flex column align-center w-h-100 layout-row",children:[(0,n.jsx)("a",{href:"/admin/games",title:"Return to game list?","aria-label":"Return to game list?",children:(0,n.jsx)(h.M,{iconName:"return"})}),i?(0,n.jsx)(y.a,{}):c?(0,n.jsx)(N.m,{message:c}):m?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{children:"You are now adding a new game"}),(0,n.jsx)(b,{game:g})]}):a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("h2",{children:["You are now editing ",a.title]}),(0,n.jsx)(b,{game:a}),(0,n.jsx)("p",{children:"*First image in screenshots array is to be used for thumbnail, IT WILL NOT be shown in the details page of the game*"})]}):null]})})}},1811:function(e,a,t){"use strict";t.d(a,{m:function(){return r}});var n=t(7437),l=t(6370);function r(e){let{message:a}=e;return(0,n.jsxs)("article",{className:"error-container flex column",children:[(0,n.jsxs)("div",{className:"error-area flex row align-center",children:[(0,n.jsx)(l.ImageContainer,{src:"https://res.cloudinary.com/djzid7ags/image/upload/v1716704407/hgqpxtysqdjvav72w8dl.avif",alt:"Error.."}),(0,n.jsx)("span",{children:a})]}),(0,n.jsx)("a",{href:"/","aria-label":"Go to home page",title:"Return to home page?",children:"Return to home?"})]})}},6168:function(e,a,t){"use strict";t.d(a,{p:function(){return r}});var n=t(7437),l=t(2265);function r(e){let{string:a,custom:t}=e;return(0,n.jsx)("p",{className:t,children:a.split("<br>").map((e,a,t)=>(0,n.jsxs)(l.Fragment,{children:[e,a<t.length-1&&(0,n.jsx)("br",{})]},a))})}},8804:function(e,a,t){"use strict";t.d(a,{N:function(){return l}});var n=t(2265);function l(e,a){let[t,l]=(0,n.useState)(e);return(0,n.useEffect)(()=>{let t=setTimeout(()=>{l(e)},a);return()=>clearTimeout(t)},[e,a]),t}},1641:function(e,a,t){"use strict";t.d(a,{R:function(){return r}});var n=t(1635);let l="game/",r={query:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let a=new URLSearchParams(e).toString();return n.R.get("".concat(l,"?").concat(a))}catch(e){throw Error(e.message)}},getById:async e=>{try{return n.R.get("".concat(l,"by-id/").concat(e))}catch(e){throw Error(e.message)}},getByName:async e=>{try{return n.R.get("".concat(l,"by-name/").concat(e))}catch(e){throw Error(e.message)}},checkNameAvailable:async e=>n.R.get("".concat(l,"check-name/").concat(e)),save:async e=>{try{if(e._id)return n.R.put("".concat(l,"update/").concat(e._id),e);return n.R.post(l+"add/",e)}catch(e){throw Error(e.message)}},remove:async e=>{try{return n.R.remove("".concat(l,"delete/").concat(e))}catch(e){throw Error(e.message)}},getGenres:()=>[{label:"Any",value:"",iconName:"globe"},{label:"Action",value:"action",iconName:"action"},{label:"Adventure",value:"adventure",iconName:"adventure"},{label:"Other",value:"other",iconName:"questionMark"},{label:"Platformer",value:"platformer",iconName:"platformer"},{label:"Puzzle",value:"puzzle",iconName:"puzzle"},{label:"Roguelike",value:"roguelike",iconName:"dice"},{label:"Strategy",value:"strategy",iconName:"rook"}],getPlatforms:()=>[{label:"Any",value:"",iconName:"globe"},{label:"Android",value:"android",iconName:"android"},{label:"Browser",value:"html5",iconName:"html5"},{label:"Steam",value:"steam",iconName:"steam"}],getGameJams:()=>[{label:"Any",value:"",iconName:"globe"},{label:"Yes",value:"yes",iconName:"confirm"},{label:"No",value:"no",iconName:"cancel"}]}}},function(e){e.O(0,[648,148,669,971,23,744],function(){return e(e.s=8849)}),_N_E=e.O()}]);